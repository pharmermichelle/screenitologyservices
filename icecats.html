<!DOCTYPE html>
<html lang="en">
  <head>
    <!-- Google tag (gtag.js) -->
    <script
      async
      src="https://www.googletagmanager.com/gtag/js?id=G-3PJT7ZWXRR"
    ></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() {
        dataLayer.push(arguments);
      }
      gtag("js", new Date());

      gtag("config", "G-3PJT7ZWXRR");
    </script>

    <meta charset="utf-8" />
    <title>Pee Dee IceCats Interest | ScreenITology</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta
      name="description"
      content="Interest form for Pee Dee IceCats ticket packages, theme nights, suite rentals, charity events and more."
    />
    <style>
        :root {
  --icecats-navy: #051a35;
  --icecats-blue: #4bb5e5;
  --icecats-red: #e63b4d;
  --icecats-grey: #c0c6d2;
}

body {
  margin: 0;
  font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
  background: radial-gradient(circle at top left, #0b2345, #050814 60%);
  color: #f6f8fb;
}

.icecats-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 16px;
  margin-bottom: 12px;
}

.icecats-brand {
  display: flex;
  align-items: center;
  gap: 16px;
}

.icecats-logo {
  width: 72px;
  height: 72px;
  flex-shrink: 0;
}

.icecats-title {
  margin: 0 0 4px;
  font-size: 1.6rem;
}

.icecats-subtitle {
  margin: 0;
  color: var(--icecats-grey);
  font-size: 0.9rem;
  max-width: 40rem;
}

.admin-link {
  font-size: 0.85rem;
  border-radius: 999px;
  border: 1px solid rgba(255,255,255,0.2);
  padding: 6px 14px;
  color: var(--icecats-blue);
  text-decoration: none;
  white-space: nowrap;
}

.admin-link:hover {
  border-color: var(--icecats-blue);
  background: rgba(75,181,229,0.12);
}
.card {
  background: rgba(5, 18, 45, 0.96);
  border: 1px solid rgba(75,181,229,0.35);
  border-radius: 16px;
  padding: 20px;
  margin-top: 16px;
}

      
    </style>
  </head>
  <body>

  <div class="wrap">
    <header class="icecats-header">
      <div class="icecats-brand">
        <img src="/assets/icecats-logo.png" alt="Pee Dee IceCats logo" class="icecats-logo" />
        <div>
          <h1 class="icecats-title">Pee Dee IceCats Interest</h1>
          <p class="icecats-subtitle">
            Let us know what youâ€™re interested in for Pee Dee IceCats hockey. A team member will follow up with details and availability.
          </p>
        </div>
      </div>
      <a id="admin-link" href="/icecats-admin.html" class="admin-link">Admin login</a>
    </header>


    <script>
      (function () {
        const SUPABASE_URL = "https://mltzrwltaheaunrdmyfb.supabase.co";
        const SUPABASE_ANON_KEY =
          "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im1sdHpyd2x0YWhlYXVucmRteWZiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ2NDk3MjgsImV4cCI6MjA4MDIyNTcyOH0.B7MvOu1wZ5LsRis5f7B-srJsaadOmN7FdV4PlNQvn2E";

        const form = document.getElementById("icecats-form");
        const thanks = document.getElementById("thanks");

        if (!form) return;

        form.addEventListener("submit", async function (e) {
          e.preventDefault();

          if (form.hp && form.hp.value) return; // honeypot

          const checked = Array.from(
            form.querySelectorAll('input[name="interest"]:checked')
          ).map((el) => el.value);

          const payload = {
            name: form.name.value.trim(),
            email: form.email.value.trim(),
            org: form.org.value.trim(),
            interests: checked, // this will go into jsonb
            notes: form.notes.value.trim(),
          };

          if (!payload.name || !payload.email) {
            alert("Please enter your name and email.");
            return;
          }

          try {
            const res = await fetch(
              SUPABASE_URL + "/rest/v1/icecats_submissions",
              {
                method: "POST",
                headers: {
                  "Content-Type": "application/json",
                  apikey: SUPABASE_ANON_KEY,
                  Authorization: "Bearer " + SUPABASE_ANON_KEY,
                  Prefer: "return=minimal",
                },
                body: JSON.stringify(payload),
              }
            );

            if (!res.ok) {
              console.error(await res.text());
              alert(
                "There was a problem submitting your interest. Please try again or contact the team directly."
              );
              return;
            }

            form.reset();
            if (thanks) thanks.style.display = "block";
          } catch (err) {
            console.error(err);
            alert(
              "There was a problem submitting your interest. Please try again later."
            );
          }
        });
      })();
    </script>
  </body>
</html>
